---
title: 'SLIX: A Python package for fully automated evaluation of Scattered Light Imaging measurements on brain tissue'
tags:
  - Python
  - light scattering
  - dark-field microscopy
  - brain architecture
  - connectivity
  - nerve fiber crossings
authors:
  - name: Jan A. Reuter
    orcid: 0000-0002-1219-0310
    affiliation: 1 # (Multiple affiliations must be quoted)
  - name: Miriam Menzel
    orcid: 0000-0002-6042-7490
    affiliation: 1
affiliations:
  - name: Institute of Neuroscience and Medicine (INM-1), Forschungszentrum Jülich GmbH, 52425 Jülich, Germany
    index: 1
date: 18 August 2020
bibliography: paper.bib
---

# Summary

To study the structure and function of the brain, a detailed reconstruction of the brain's nerve fiber architecture is required. Many neuroimaging techniques, however, struggle with the correct reconstruction of crossing nerve fibers. 
The recently developed technique *Scattered Light Imaging (SLI)* resolves the substructure of (crossing) nerve fibers in whole brain sections with micrometer resolution [@menzel2020-NeuroImage]. The measurement principle was first introduced by @menzel2020. Unstained histological brain sections are illuminated from different angles and the transmitted (scattered) light behind the sample is measured under normal incidence. Every pixel in the resulting SLI image series contains a light intensity profile which is characteristic for the brain tissue structure at this point. The number and position of significant peaks in the line profiles can be used, for example, to determine the individual orientations of (crossing) nerve fibers in each image pixel. 

Here, we present the *Scattered Light Imaging ToolboX* (`SLIX`) - an open-source Python package that allows for the first time a fully automated evaluation of the SLI measurements and the generation of different parameter maps (see Figure \ref{figure2}) which reflect different characteristics of the line profiles: the number of peaks, the average peak prominence, the average peak width, the distance between peaks, and the position of the peaks from which the in-plane direction angles of the nerve fibers in regions with up to three crossing nerve fiber bundles are computed. The user can choose which parameter maps are generated by using specific command line parameters.

Depending on the number of illumination angles used in the SLI measurement, the line profiles are discretized, typically in steps between 1° and 22.5°. For small step sizes, the line profiles show a zig-zag line with many minor peaks which are not of interest (cf. Figure \ref{figure}(a), in orange). Therefore, the software offers smoothing to suppress these undesired features and study the overall structure of the peaks (Figure \ref{figure}(a), in black). For large step sizes, the line profiles are strongly discretized  (cf. Figure \ref{figure}(b)) so that the position of the peaks does not necessarily correspond to the position of the peaks in the non-discretized profiles. The software improves the accuracy of the determined peak positions by taking the centroid of the peak tips into account (see @menzel2020-NeuroImage for more details).

`SLIX` has already been used to study nerve fiber architectures in human, monkey, and rodent brain tissue samples, and to unravel complex arrangements of crossing nerve fibers like the corona radiata of the vervet monkey brain [@menzel2020-NeuroImage]. 

For a full documentation of `SLIX`, the reader is referred to our [GitHub page](https://github.com/3d-pli/SLIX).


![(a) Line profile measured in steps of 1° (orange: original line profile, black: smoothed line profile). (b) Line profile measured in steps of 15°. The prominence of the peaks (in red) is computed by the difference between the top of the peak and the highest of the two neighbored minima. Peaks with a prominence of 8% of the total signal amplitude (max - min) are called *prominent* peaks. In this example, there are 5 peaks in total and 4 prominent peaks (in green). The peak width is determined as the full width of the peak at a height corresponding to the peak height minus half of the peak prominence. The determined positions of the peaks (vertical lines) have been slightly corrected by computing the centroid of the peak tip as described in @menzel2020-NeuroImage to account for discretization artefacts.\label{figure}](figure.pdf){width=100%}

## Example

Figure \ref{figure2} shows parameter maps generated with `SLIX` for two artificially crossing sections of human optic tracts. The sections were delineated by black contour lines for better reference. The direction maps (g,h) can be used to visualize the individual orientations of in-plane (crossing) nerve fibers (i).

# Acknowledgements
The authors thank Markus Axer and Katrin Amunts for their continuous support. 
This work was funded by the Helmholtz Association port-folio theme "Supercomputing and Modeling for the Human Brain" and by the European Union's Horizon 2020 Framework Programme for Research and Innovation under the Specific Grant Agreement No. 785907 and 945539 ("Human Brain Project" SGA2 and SGA3).

![Parameter maps generated with `SLIX`, shown exemplary for two artificially crossing sections of human optic tracts: (a) average of the line profiles; (b/c) number of all/prominent peaks in the line profiles; (d) average prominence of the peaks in the line profiles, normalized by the average of the line profile; (e) average width of all prominent peaks in the line profiles; (f) distance between two prominent peaks; (g/h) in-plane direction angles of the nerve fibers (two out of three possible directions); (i) visualization of direction angles in g and h, showing the crossing nerve fibers in the center. This figure has been adapted from @menzel2020-NeuroImage, Figure 8.\label{figure2}](figure2.pdf){width=100%}

# References
