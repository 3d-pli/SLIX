---
title: 'SLIX: A Python package for fully automated evaluation of Scattered Light Imaging measurements on brain tissue'
tags:
  - Python
  - light scattering
  - dark-field microscopy
  - brain architecture
  - connectivity
  - nerve fiber crossings
authors:
  - name: Jan A. Reuter
    orcid: 0000-0002-1219-0310
    affiliation: 1 # (Multiple affiliations must be quoted)
  - name: Miriam Menzel
    orcid: 0000-0002-6042-7490
    affiliation: 1
affiliations:
  - name: Institute of Neuroscience and Medicine (INM-1), Forschungszentrum Jülich GmbH, 52425 Jülich, Germany
    index: 1
date: 18 August 2020
bibliography: paper.bib
---

# Summary

To study the structure and function of the brain, a detailed reconstruction of the brain's nerve fiber architecture is required. However, many neuroimaging techniques, such as 3D-Polarized Light Imaging [@MAxer2011_1,@MAxer2011_2], struggle with the correct reconstruction of crossing nerve fibers. 
The recently developed technique *Scattered Light Imaging (SLI)* allows to explore the substructure of (crossing) nerve fibers in whole brain sections with micrometer resolution, by providing crucial information such as the orientations of crossing nerve fibers in a measured image pixel [@menzel2020-NeuroImage]. The measurement principle was first introduced by @menzel2020. Unstained histological brain sections are illuminated from different angles and the transmitted (scattered) light behind the sample is measured under normal incidence (see Figure \ref{figure}a). Every pixel in the resulting SLI image series contains a light intensity profile (*SLI profile* $I(\phi)$, cf. Figure \ref{figure}b-c) which is characteristic for the brain tissue structure at this point. The number and position of significant peaks in the SLI profiles can be used, for example, to determine the individual orientations of (crossing) nerve fibers in each image pixel. 

Here, we present the *Scattered Light Imaging ToolboX* (`SLIX`) &ndash; an open-source Python package that allows for the first time a fully automated evaluation of SLI measurements and the generation of different parameter maps (see Figure \ref{figure2}a-h) which reflect different characteristics of the SLI profiles: the average, the number of peaks, the average peak prominence, the average peak width, the distance between peaks, and the position of the peaks from which the in-plane direction angles of the nerve fibers are computed in regions with up to three crossing nerve fiber bundles. The user can choose which parameter maps are generated by using specific command line parameters. The resulting direction maps can be used to visualize the individual orientations of in-plane (crossing) nerve fibers, as shown in Figure \ref{figure2}i.

Depending on the number of illumination angles used in the SLI measurement, the line profiles are discretized, typically in steps between 1° and 22.5°. For small step sizes, the line profiles show a zig-zag line with many minor peaks which are not of interest (cf. Figure \ref{figure}c, in orange). Therefore, the software offers smoothing to suppress these undesired features and study the overall structure of the peaks (Figure \ref{figure}c, in black). For large step sizes, the line profiles are strongly discretized  (cf. Figure \ref{figure}b) so that the position of the peaks does not necessarily correspond to the position of the peaks in the non-discretized profiles. The software improves the accuracy of the determined peak positions by taking the centroid of the peak tips into account (see @menzel2020-NeuroImage for more details).

`SLIX` has already been used to study nerve fiber architectures in human, monkey, and rodent brain tissue samples, and to unravel complex arrangements of crossing nerve fibers like the corona radiata of the vervet monkey brain [@menzel2020-NeuroImage]. 

For a full documentation of `SLIX`, the reader is referred to our [GitHub page](https://github.com/3d-pli/SLIX).


![(a) Schematic drawing of the SLI measurement: The sample is illuminated from different angles (with constant polar angle $\theta$ and different equidistant azimuthal angles $\phi$) and the transmitted light behind the sample is measured under normal incidence. Each pixel in the resulting image series contains a characteristic light intensity profile (SLI profile $I(\phi)$). (b) SLI profile measured in steps of 15°. The prominence of the peaks (in red) is computed by the difference between the top of the peak and the highest of the two neighboring minima. The peak width (dark blue) is determined as the full width of the peak at a height corresponding to the peak height minus half of the peak prominence. The determined positions of the peaks (vertical lines) have been slightly corrected by computing the centroid of the peak tip as described in @menzel2020-NeuroImage, Appx. B to account for discretization artifacts. Only *prominent* peaks, i.e. peaks with a prominence above 8% of the total signal amplitude (max - min), are used for further evaluation (green/magenta lines). Peaks with lower prominences are expected to be caused by noise or details in the fiber structure that are not of interest (for derivation see @menzel2020-NeuroImage, Appx. A). The fiber direction angles $\varphi_1$ and $\varphi_2$ are computed from the mid positions of the prominent peak pairs. (c)  SLI profile measured in steps of 1° (orange: original line profile, black: smoothed line profile).\label{figure}](figure_.pdf){width=100%}

# Acknowledgements
The authors thank Markus Axer and Katrin Amunts for their continuous support. 
This work was funded by the Helmholtz Association port-folio theme "Supercomputing and Modeling for the Human Brain" and by the European Union's Horizon 2020 Framework Programme for Research and Innovation under the Specific Grant Agreement No. 785907 and 945539 ("Human Brain Project" SGA2 and SGA3).

# References

![Parameter maps generated with `SLIX`, shown exemplary for two artificially crossing sections of human optic tracts: (a) average intensity in the SLI profiles; (b/c) number of all/prominent peaks in the SLI profiles; (d) average prominence of the peaks in the SLI profiles, normalized by the average of the profile; (e) average width of all prominent peaks in the SLI profiles; (f) distance between two prominent peaks; (g/h) in-plane direction angles of the nerve fibers (two out of three possible directions); (i) visualization of direction angles in g and h, showing the crossing nerve fibers in the center. This figure has been adapted from @menzel2020-NeuroImage, Figure 8. Subfigures a-h were generated with `SLIX`, using a viridis color map to display the results and manually masking the tissue regions. Subfigure b shows the number of all peaks, i.e. the sum of low and high prominence peaks. Subfigure i was generated from the results in g,h by representing the direction angles of 24x24 pixels by a line with the respective polar/direction angle (not part of the software).  \label{figure2}](figure2.pdf){width=90%}


